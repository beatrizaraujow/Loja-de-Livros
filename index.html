<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Livraria Letras Mágicas</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100">
    <!-- Cabeçalho -->
    <header class="bg-blue-900 text-white shadow-md">
        <div class="container mx-auto px-4 py-3 flex justify-between items-center">
            <div class="flex items-center space-x-2">
                <button id="mobile-menu" class="md:hidden text-2xl">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="text-2xl font-bold">Letras Mágicas</h1>
            </div>
            
            <div class="hidden md:flex items-center space-x-6">
                <a href="#" class="hover:text-blue-200">Início</a>
                <a href="#" class="hover:text-blue-200">Categorias</a>
                <a href="#" class="hover:text-blue-200">Promoções</a>
                <a href="#" class="hover:text-blue-200">Contato</a>
            </div>
            
            <div class="flex items-center space-x-4">
                <div class="relative">
                    <button id="cart-button" class="text-xl">
                        <i class="fas fa-shopping-cart"></i>
                        <span id="cart-count" class="absolute -top-2 -right-2 bg-red-600 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center">0</span>
                    </button>
                </div>
                <button class="bg-blue-700 hover:bg-blue-600 px-4 py-1 rounded">Login</button>
            </div>
        </div>
    </header>

    <!-- Filtros mobile -->
    <button id="filter-toggle" class="md:hidden bg-blue-800 text-white w-full py-2 px-4 text-left">
        <i class="fas fa-filter mr-2"></i>Filtrar
    </button>

    <!-- Conteúdo principal -->
    <main class="container mx-auto px-4 py-6 flex flex-col md:flex-row">
        <!-- Filtros -->
        <aside id="filter-section" class="filter-section w-full md:w-1/4 lg:w-1/5 pr-0 md:pr-6 mb-6 md:mb-0">
            <div class="bg-white p-4 rounded shadow">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-lg font-semibold">Filtros</h2>
                    <button class="md:hidden" id="close-filters">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Categorias</h3>
                    <ul>
                        <li class="mb-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="category-filter" value="ficcao" checked>
                                <span class="ml-2">Ficção</span>
                            </label>
                        </li>
                        <li class="mb-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="category-filter" value="romance" checked>
                                <span class="ml-2">Romance</span>
                            </label>
                        </li>
                        <li class="mb-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="category-filter" value="fantasia" checked>
                                <span class="ml-2">Fantasia</span>
                            </label>
                        </li>
                        <li class="mb-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="category-filter" value="tecnologia" checked>
                                <span class="ml-2">Tecnologia</span>
                            </label>
                        </li>
                        <li class="mb-1">
                            <label class="flex items-center">
                                <input type="checkbox" class="category-filter" value="autoajuda" checked>
                                <span class="ml-2">Autoajuda</span>
                            </label>
                        </li>
                    </ul>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Faixa de Preço</h3>
                    <div class="mb-4">
                        <input type="range" id="price-range" min="0" max="100" value="100" class="w-full">
                        <div class="flex justify-between text-sm">
                            <span>R$ 0</span>
                            <span>R$ 100+</span>
                        </div>
                    </div>
                </div>
                
                <button id="apply-filters" class="w-full bg-blue-800 text-white py-2 rounded hover:bg-blue-700">
                    Aplicar Filtros
                </button>
            </div>
        </aside>
        
        <!-- Lista de livros -->
        <section class="w-full md:w-3/4 lg:w-4/5">
            <div class="mb-6 flex justify-between items-center">
                <h2 class="text-xl font-bold">Livros Disponíveis</h2>
                <div class="flex items-center">
                    <span class="mr-2">Ordenar por:</span>
                    <select id="sort-by" class="border rounded p-1">
                        <option value="relevance">Relevância</option>
                        <option value="price-asc">Preço: menor primeiro</option>
                        <option value="price-desc">Preço: maior primeiro</option>
                        <option value="title-asc">Título (A-Z)</option>
                        <option value="title-desc">Título (Z-A)</option>
                    </select>
                </div>
            </div>
            
            <div id="books-container" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                <!-- Livros serão carregados via JavaScript -->
            </div>
        </section>
    </main>
    
    <!-- Carrinho de compras (modal) -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="absolute right-0 top-0 h-full w-full md:w-1/2 lg:w-1/3 bg-white shadow-lg overflow-y-auto">
            <div class="p-4">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-xl font-bold">Seu Carrinho</h2>
                    <button id="close-cart" class="text-2xl">&times;</button>
                </div>
                
                <div id="cart-items" class="mb-6">
                    <!-- Itens do carrinho serão adicionados aqui -->
                    <p class="text-center py-4">Seu carrinho está vazio</p>
                </div>
                
                <div class="border-t pt-4">
                    <div class="flex justify-between mb-2">
                        <span>Subtotal:</span>
                        <span id="subtotal">R$ 0,00</span>
                    </div>
                    <div class="flex justify-between mb-2">
                        <span>Frete:</span>
                        <span id="shipping">R$ 0,00</span>
                    </div>
                    <div class="flex justify-between font-bold text-lg">
                        <span>Total:</span>
                        <span id="total">R$ 0,00</span>
                    </div>
                    
                    <div class="mt-6 space-y-2">
                        <button id="checkout-button" class="w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 disabled:bg-gray-400" disabled>
                            Finalizar Compra
                        </button>
                        <button id="continue-shopping" class="w-full border border-blue-800 text-blue-800 py-2 rounded hover:bg-blue-50">
                            Continuar Comprando
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de pagamento -->
    <div id="payment-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl w-11/12 md:w-2/3 lg:w-1/2 max-w-2xl">
            <div class="p-6">
                <div class="flex justify-between items-center mb-4">
                    <h2 class="text-xl font-bold">Finalizar Compra</h2>
                    <button id="close-payment" class="text-2xl">&times;</button>
                </div>
                
                <div class="mb-6">
                    <h3 class="font-medium mb-2">Resumo do Pedido</h3>
                    <div id="order-summary" class="bg-gray-100 p-3 rounded">
                        <!-- Resumo será preenchido aqui -->
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <h3 class="font-medium mb-2">Informações de Pagamento</h3>
                        
                        <div class="mb-4">
                            <label class="block text-sm mb-1">Número do Cartão</label>
                            <input type="text" id="card-number" class="w-full border rounded p-2" placeholder="1234 5678 9012 3456">
                        </div>
                        
                        <div class="flex space-x-4 mb-4">
                            <div class="flex-1">
                                <label class="block text-sm mb-1">Validade</label>
                                <input type="text" id="card-expiry" class="w-full border rounded p-2" placeholder="MM/AA">
                            </div>
                            <div class="flex-1">
                                <label class="block text-sm mb-1">CVV</label>
                                <input type="text" id="card-cvv" class="w-full border rounded p-2" placeholder="123">
                            </div>
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm mb-1">Nome no Cartão</label>
                            <input type="text" id="card-name" class="w-full border rounded p-2" placeholder="Nome como impresso no cartão">
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-medium mb-2">Endereço de Entrega</h3>
                        
                        <div class="mb-4">
                            <label class="block text-sm mb-1">CEP</label>
                            <input type="text" id="zip-code" class="w-full border rounded p-2" placeholder="00000-000">
                        </div>
                        
                        <div class="mb-4">
                            <label class="block text-sm mb-1">Endereço</label>
                            <input type="text" id="address" class="w-full border rounded p-2" placeholder="Rua, número">
                        </div>
                        
                        <div class="flex space-x-4 mb-4">
                            <div class="flex-1">
                                <label class="block text-sm mb-1">Cidade</label>
                                <input type="text" id="city" class="w-full border rounded p-2">
                            </div>
                            <div class="w-1/4">
                                <label class="block text-sm mb-1">UF</label>
                                <select id="state" class="w-full border rounded p-2">
                                    <option value="">UF</option>
                                    <option value="AC">AC</option>
                                    <option value="AL">AL</option>
                                    <option value="AP">AP</option>
                                    <option value="AM">AM</option>
                                    <option value="BA">BA</option>
                                    <option value="CE">CE</option>
                                    <option value="DF">DF</option>
                                    <option value="ES">ES</option>
                                    <option value="GO">GO</option>
                                    <option value="MA">MA</option>
                                    <option value="MT">MT</option>
                                    <option value="MS">MS</option>
                                    <option value="MG">MG</option>
                                    <option value="PA">PA</option>
                                    <option value="PB">PB</option>
                                    <option value="PR">PR</option>
                                    <option value="PE">PE</option>
                                    <option value="PI">PI</option>
                                    <option value="RJ">RJ</option>
                                    <option value="RN">RN</option>
                                    <option value="RS">RS</option>
                                    <option value="RO">RO</option>
                                    <option value="RR">RR</option>
                                    <option value="SC">SC</option>
                                    <option value="SP">SP</option>
                                    <option value="SE">SE</option>
                                    <option value="TO">TO</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="mt-6 flex flex-col space-y-2">
                    <button id="confirm-payment" class="bg-green-600 text-white py-2 rounded hover:bg-green-700">
                        Confirmar Pagamento
                    </button>
                    <button id="cancel-payment" class="border border-gray-400 py-2 rounded hover:bg-gray-100">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmação -->
    <div id="confirmation-modal" class="fixed inset-0 bg-black bg-opacity-50 z-50 hidden">
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-white rounded-lg shadow-xl w-11/12 md:w-1/2 lg:w-1/3 max-w-md p-6">
            <div class="text-center">
                <div class="text-green-500 text-5xl mb-4">
                    <i class="fas fa-check-circle"></i>
                </div>
                <h2 class="text-xl font-bold mb-2">Compra Finalizada!</h2>
                <p class="mb-6">Seu pedido foi processado com sucesso. Obrigado por comprar conosco!</p>
                <button id="close-confirmation" class="bg-blue-800 text-white px-6 py-2 rounded hover:bg-blue-700">
                    OK
                </button>
            </div>
        </div>
    </div>
    
    <!-- Rodapé -->
    <footer class="bg-blue-900 text-white py-8 mt-12">
        <div class="container mx-auto px-4">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <div>
                    <h3 class="font-bold text-lg mb-4">Letras Mágicas</h3>
                    <p>A melhor livraria online do Brasil, com milhões de títulos para você descobrir.</p>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Institucional</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="hover:text-blue-200">Sobre nós</a></li>
                        <li><a href="#" class="hover:text-blue-200">Trabalhe conosco</a></li>
                        <li><a href="#" class="hover:text-blue-200">Termos de uso</a></li>
                        <li><a href="#" class="hover:text-blue-200">Política de privacidade</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Atendimento</h3>
                    <ul class="space-y-2">
                        <li><a href="#" class="hover:text-blue-200">Central de ajuda</a></li>
                        <li><a href="#" class="hover:text-blue-200">Entregas e prazos</a></li>
                        <li><a href="#" class="hover:text-blue-200">Trocas e devoluções</a></li>
                        <li><a href="#" class="hover:text-blue-200">Fale conosco</a></li>
                    </ul>
                </div>
                <div>
                    <h3 class="font-bold text-lg mb-4">Formas de Pagamento</h3>
                    <div class="grid grid-cols-3 gap-2">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/8b6f5b23-c3c3-4ca7-bbfe-6cc4238ce9d4.png" alt="Logo Visa - cartão de crédito" class="h-10">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/69d81361-5db4-4c2f-9c73-8e5cdaf5f8ed.png" alt="Logo Mastercard - cartão de crédito" class="h-10">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1cbecd87-aaa3-4fa5-b0fe-ebff54c2f663.png" alt="Logo American Express - cartão de crédito" class="h-10">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/5c0a3544-0131-4ceb-9779-2bbc51df9c73.png" alt="Logo PIX - forma de pagamento" class="h-10">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/1d0a5755-6995-41cc-99fd-504ad873a7cc.png" alt="Logo Boleto - forma de pagamento" class="h-10">
                        <img src="https://storage.googleapis.com/workspace-0f70711f-8b4e-4d94-86f1-2a93ccde5887/image/c34d279f-a973-49a7-b718-6d890938e60b.png" alt="Logo PayPal - forma de pagamento" class="h-10">
                    </div>
                </div>
            </div>
            
            <div class="border-t border-blue-800 mt-8 pt-6 text-center">
                <p>© 2025 Letras Mágicas. Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript -->
    <script>
        // Dados dos livros
        const books = [
            {
                id: 1,
                title: "O Senhor dos Anéis - A Sociedade do Anel",
                author: "J.R.R. Tolkien",
                price: 49.90,
                rating: 4.8,
                category: "fantasia",
                description: "O primeiro volume da famosa trilogia de fantasia que narra a jornada de Frodo para destruir o Um Anel.",
                cover: "https://m.media-amazon.com/images/I/41cJavOdzRL._SY300_SX300_QL70_ML2_.jpg",
                stock: 10
            },
            {
                id: 2,
                title: "1984",
                author: "George Orwell",
                price: 29.90,
                rating: 4.7,
                category: "ficcao",
                description: "Um clássico distópico sobre vigilância governamental e controle da sociedade.",
                cover: "https://m.media-amazon.com/images/I/51feD87yuEL._SY445_SX342_ControlCacheEqualizer_.jpg",
                stock: 15
            },
            {
                id: 3,
                title: "Orgulho e Preconceito",
                author: "Jane Austen",
                price: 34.90,
                rating: 4.9,
                category: "romance",
                description: "Uma das maiores histórias de amor da literatura inglesa, narrando o relacionamento entre Elizabeth Bennet e Mr. Darcy.",
                cover: "https://m.media-amazon.com/images/I/51AHB+f-0DL._SY445_SX342_ControlCacheEqualizer_.jpg",
                stock: 8
            },
            {
                id: 4,
                title: "O Poder do Hábito",
                author: "Charles Duhigg",
                price: 39.90,
                rating: 4.5,
                category: "autoajuda",
                description: "Um olhar científico sobre como os hábitos funcionam e como podemos mudá-los.",
                cover: "https://m.media-amazon.com/images/I/815+4rm+F-L._SY425_.jpg",
                stock: 12
            },
            {
                id: 5,
                title: "Código Limpo",
                author: "Robert C. Martin",
                price: 89.90,
                rating: 4.6,
                category: "tecnologia",
                description: "Um manual essencial para qualquer desenvolvedor que queira escrever código mais legível e eficiente.",
                cover: "https://m.media-amazon.com/images/I/41aHzYSXZkL._SY445_SX342_ControlCacheEqualizer_.jpg",
                stock: 5
            },
            {
                id: 6,
                title: "Harry Potter e a Pedra Filosofal",
                author: "J.K. Rowling",
                price: 42.90,
                rating: 4.9,
                category: "fantasia",
                description: "O primeiro livro da famosa série que apresenta o mundo mágico de Harry Potter.",
                cover: "https://m.media-amazon.com/images/I/51lRMYwP-4L._SY445_SX342_ControlCacheEqualizer_.jpg",
                stock: 20
            },
            {
                id: 7,
                title: "A Revolução dos Bichos",
                author: "George Orwell",
                price: 24.90,
                rating: 4.6,
                category: "ficcao",
                description: "Uma sátira política em forma de fábula sobre os perigos do totalitarismo.",
                cover: "https://m.media-amazon.com/images/I/51VpNZzWTxL._SY445_SX342_ControlCacheEqualizer_.jpg",
                stock: 18
            },
            {
                id: 8,
                title: "Como Fazer Amigos e Influenciar Pessoas",
                author: "Dale Carnegie",
                price: 37.90,
                rating: 4.4,
                category: "autoajuda",
                description: "Um guia clássico para melhorar suas habilidades sociais e de comunicação.",
                cover: "https://m.media-amazon.com/images/I/71x-i7sKSvL._SY425_.jpg",
                stock: 7
            }
        ];
        
        // Carrinho de compras
        let cart = [];
        
        // Variáveis globais para filtros
        let activeCategories = ['ficcao', 'romance', 'fantasia', 'tecnologia', 'autoajuda'];
        let maxPrice = 100;
        let sortBy = 'relevance';
        
        // Elementos do DOM
        const booksContainer = document.getElementById('books-container');
        const cartButton = document.getElementById('cart-button');
        const cartModal = document.getElementById('cart-modal');
        const closeCart = document.getElementById('close-cart');
        const cartItems = document.getElementById('cart-items');
        const cartCount = document.getElementById('cart-count');
        const subtotal = document.getElementById('subtotal');
        const total = document.getElementById('total');
        const shipping = document.getElementById('shipping');
        const checkoutButton = document.getElementById('checkout-button');
        const continueShopping = document.getElementById('continue-shopping');
        const paymentModal = document.getElementById('payment-modal');
        const closePayment = document.getElementById('close-payment');
        const confirmPayment = document.getElementById('confirm-payment');
        const cancelPayment = document.getElementById('cancel-payment');
        const confirmationModal = document.getElementById('confirmation-modal');
        const closeConfirmation = document.getElementById('close-confirmation');
        const filterToggle = document.getElementById('filter-toggle');
        const filterSection = document.getElementById('filter-section');
        const closeFilters = document.getElementById('close-filters');
        const applyFilters = document.getElementById('apply-filters');
        const priceRange = document.getElementById('price-range');
        const sortSelect = document.getElementById('sort-by');
        
        // Inicialização
        document.addEventListener('DOMContentLoaded', () => {
            renderBooks();
            setupEventListeners();
        });
        
        function setupEventListeners() {
            // Carrinho
            cartButton.addEventListener('click', toggleCart);
            closeCart.addEventListener('click', toggleCart);
            continueShopping.addEventListener('click', toggleCart);
            checkoutButton.addEventListener('click', showPaymentModal);
            
            // Filtros
            filterToggle.addEventListener('click', () => {
                filterSection.classList.toggle('active');
            });
            
            closeFilters.addEventListener('click', () => {
                filterSection.classList.remove('active');
            });
            
            priceRange.addEventListener('input', (e) => {
                document.querySelector('#price-range + div span:last-child').textContent = `R$ ${e.target.value}+`;
            });
            
            applyFilters.addEventListener('click', applyFiltersHandler);
            
            // Ordenação
            sortSelect.addEventListener('change', (e) => {
                sortBy = e.target.value;
                renderBooks();
            });
            
            // Pagamento
            closePayment.addEventListener('click', () => {
                paymentModal.classList.add('hidden');
            });
            
            cancelPayment.addEventListener('click', () => {
                paymentModal.classList.add('hidden');
            });
            
            confirmPayment.addEventListener('click', processPayment);
            
            // Confirmação
            closeConfirmation.addEventListener('click', () => {
                confirmationModal.classList.add('hidden');
            });
        }
        
        function renderBooks() {
            booksContainer.innerHTML = '';
            
            // Filtros e ordenação
            let filteredBooks = books
                .filter(book => activeCategories.includes(book.category))
                .filter(book => book.price <= maxPrice)
                .sort(sortBooks);
            
            if (filteredBooks.length === 0) {
                booksContainer.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <h3 class="text-xl font-medium mb-2">Nenhum livro encontrado</h3>
                        <p class="text-gray-600">Tente ajustar seus filtros para encontrar mais opções.</p>
                    </div>
                `;
                return;
            }
            
            filteredBooks.forEach(book => {
                const isInCart = cart.some(item => item.id === book.id);
                
                const bookCard = document.createElement('div');
                bookCard.className = 'book-card bg-white rounded-lg overflow-hidden shadow-md hover:shadow-lg transition-all duration-300';
                bookCard.innerHTML = `
                    <div class="h-full flex flex-col">
                        <div class="h-48 overflow-hidden">
                            <img src="${book.cover}" alt="Capa do livro ${book.title} por ${book.author}" class="w-full h-full object-cover">
                        </div>
                        <div class="p-4 flex-grow flex flex-col">
                            <h3 class="font-bold text-lg mb-1">${book.title}</h3>
                            <p class="text-gray-600 text-sm mb-2">${book.author}</p>
                            <div class="flex items-center mb-3">
                                <div class="text-yellow-500 mr-1">
                                    ${renderRatingStars(book.rating)}
                                </div>
                                <span class="text-xs text-gray-500">${book.rating.toFixed(1)}</span>
                            </div>
                            <p class="text-gray-700 text-sm mb-4 flex-grow">${book.description}</p>
                            <div class="flex justify-between items-end">
                                <div>
                                    <p class="text-lg font-bold text-blue-800">R$ ${book.price.toFixed(2)}</p>
                                    <p class="text-xs text-gray-500">${book.stock} em estoque</p>
                                </div>
                                <button class="add-to-cart ${isInCart ? 'bg-gray-500' : 'bg-blue-800 hover:bg-blue-700'} text-white px-3 py-1 rounded text-sm transition-colors" data-id="${book.id}">
                                    ${isInCart ? 'No carrinho' : 'Adicionar'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
                
                booksContainer.appendChild(bookCard);
            });
            
            // Adiciona eventos aos botões de adicionar ao carrinho
            document.querySelectorAll('.add-to-cart').forEach(button => {
                button.addEventListener('click', (e) => {
                    const bookId = parseInt(e.target.getAttribute('data-id'));
                    addToCart(bookId);
                });
            });
        }
        
        function renderRatingStars(rating) {
            let stars = '';
            const fullStars = Math.floor(rating);
            const hasHalfStar = rating % 1 >= 0.5;
            
            for (let i = 0; i < 5; i++) {
                if (i < fullStars) {
                    stars += '<i class="fas fa-star"></i>';
                } else if (i === fullStars && hasHalfStar) {
                    stars += '<i class="fas fa-star-half-alt"></i>';
                } else {
                    stars += '<i class="far fa-star"></i>';
                }
            }
            
            return stars;
        }
        
        function sortBooks(a, b) {
            switch (sortBy) {
                case 'price-asc':
                    return a.price - b.price;
                case 'price-desc':
                    return b.price - a.price;
                case 'title-asc':
                    return a.title.localeCompare(b.title);
                case 'title-desc':
                    return b.title.localeCompare(a.title);
                case 'relevance':
                default:
                    return (b.rating * 100 + b.stock) - (a.rating * 100 + a.stock);
            }
        }
        
        function applyFiltersHandler() {
            activeCategories = Array.from(document.querySelectorAll('.category-filter:checked')).map(el => el.value);
            maxPrice = parseInt(priceRange.value);
            filterSection.classList.remove('active');
            renderBooks();
        }
        
        function addToCart(bookId) {
            const book = books.find(b => b.id === bookId);
            
            if (!book) return;
            
            const existingItem = cart.find(item => item.id === bookId);
            
            if (existingItem) {
                if (existingItem.quantity < book.stock) {
                    existingItem.quantity++;
                } else {
                    alert(`Só temos ${book.stock} unidades deste livro em estoque.`);
                    return;
                }
            } else {
                cart.push({
                    id: book.id,
                    title: book.title,
                    price: book.price,
                    cover: book.cover,
                    quantity: 1
                });
            }
            
            updateCart();
            renderBooks();
        }
        
        function removeFromCart(bookId) {
            cart = cart.filter(item => item.id !== bookId);
            updateCart();
            renderBooks();
        }
        
        function updateCart() {
            // Atualiza contador
            const itemCount = cart.reduce((total, item) => total + item.quantity, 0);
            cartCount.textContent = itemCount;
            cartCount.style.display = itemCount > 0 ? 'flex' : 'none';
            
            // Atualiza itens do carrinho
            cartItems.innerHTML = '';
            
            if (cart.length === 0) {
                cartItems.innerHTML = '<p class="text-center py-4">Seu carrinho está vazio</p>';
                checkoutButton.disabled = true;
                subtotal.textContent = 'R$ 0,00';
                shipping.textContent = 'R$ 0,00';
                total.textContent = 'R$ 0,00';
                return;
            }
            
            checkoutButton.disabled = false;
            
            let cartTotal = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                cartTotal += itemTotal;
                
                const cartItem = document.createElement('div');
                cartItem.className = 'flex items-center py-3 border-b border-gray-200';
                cartItem.innerHTML = `
                    <div class="w-16 h-16 overflow-hidden rounded mr-3">
                        <img src="${item.cover}" alt="Capa do livro ${item.title}" class="w-full h-full object-cover">
                    </div>
                    <div class="flex-grow">
                        <p class="font-medium">${item.title}</p>
                        <p class="text-sm text-gray-500">Quantidade: ${item.quantity}</p>
                    </div>
                    <div class="text-right">
                        <p class="font-medium">R$ ${itemTotal.toFixed(2)}</p>
                        <button class="cart-item-remove text-red-500 text-sm transition-all" data-id="${item.id}">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                `;
                
                cartItems.appendChild(cartItem);
            });
            
            // Adiciona eventos aos botões de remover
            document.querySelectorAll('.cart-item-remove').forEach(button => {
                button.addEventListener('click', (e) => {
                    const bookId = parseInt(e.target.closest('button').getAttribute('data-id'));
                    removeFromCart(bookId);
                });
            });
            
            // Calcula totais
            const shippingCost = cartTotal > 100 ? 0 : 10;
            
            subtotal.textContent = `R$ ${cartTotal.toFixed(2)}`;
            shipping.textContent = `R$ ${shippingCost.toFixed(2)}`;
            total.textContent = `R$ ${(cartTotal + shippingCost).toFixed(2)}`;
        }
        
        function toggleCart() {
            cartModal.classList.toggle('hidden');
        }
        
        function showPaymentModal() {
            // Atualiza resumo do pedido
            const orderSummary = document.getElementById('order-summary');
            orderSummary.innerHTML = '';
            
            let summaryHTML = '';
            let cartTotal = 0;
            
            cart.forEach(item => {
                const itemTotal = item.price * item.quantity;
                cartTotal += itemTotal;
                
                summaryHTML += `
                    <div class="flex justify-between py-2 border-b border-gray-200">
                        <span>${item.title} (${item.quantity}x)</span>
                        <span class="font-medium">R$ ${itemTotal.toFixed(2)}</span>
                    </div>
                `;
            });
            
            const shippingCost = cartTotal > 100 ? 0 : 10;
            
            summaryHTML += `
                <div class="flex justify-between py-2 border-b border-gray-200 mt-2">
                    <span>Subtotal</span>
                    <span class="font-medium">R$ ${cartTotal.toFixed(2)}</span>
                </div>
                <div class="flex justify-between py-2 border-b border-gray-200">
                    <span>Frete</span>
                    <span class="font-medium">R$ ${shippingCost.toFixed(2)}</span>
                </div>
                <div class="flex justify-between py-2 font-bold mt-2">
                    <span>Total</span>
                    <span>R$ ${(cartTotal + shippingCost).toFixed(2)}</span>
                </div>
            `;
            
            orderSummary.innerHTML = summaryHTML;
            
            // Mostra modal
            cartModal.classList.add('hidden');
            paymentModal.classList.remove('hidden');
        }
        
        function processPayment() {
            // Validação simples
            const cardNumber = document.getElementById('card-number').value;
            const cardExpiry = document.getElementById('card-expiry').value;
            const cardCVV = document.getElementById('card-cvv').value;
            const cardName = document.getElementById('card-name').value;
            const zipCode = document.getElementById('zip-code').value;
            const address = document.getElementById('address').value;
            const city = document.getElementById('city').value;
            const state = document.getElementById('state').value;
            
            if (!cardNumber || !cardExpiry || !cardCVV || !cardName || !zipCode || !address || !city || !state) {
                alert('Por favor, preencha todos os campos obrigatórios.');
                return;
            }
            
            // Simulação de processamento
            setTimeout(() => {
                paymentModal.classList.add('hidden');
                confirmationModal.classList.remove('hidden');
                cart = [];
                updateCart();
            }, 1500);
        }
    </script>
</body>

</html>
